@inject IJSRuntime JSRuntime
@implements IAsyncDisposable

<div id="@ContainerId" style="width: 100%; height: 500px; border-radius: 8px; overflow: hidden; background-color: #eee;"></div>

@code {
    [Parameter] public string ContainerId { get; set; } = "cesiumContainer_" + Guid.NewGuid().ToString("N");

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JSRuntime.InvokeVoidAsync("cesiumHelpers.initialize", ContainerId);
        }
    }

    public async Task AddEntityAsync(string entityJson)
    {
        await JSRuntime.InvokeVoidAsync("cesiumHelpers.addEntity", entityJson);
    }

    public async Task ClearEntitiesAsync()
    {
        await JSRuntime.InvokeVoidAsync("cesiumHelpers.clearEntities");
    }

    public async Task FlyToAsync(double lat, double lon, double height)
    {
        await JSRuntime.InvokeVoidAsync("cesiumHelpers.flyTo", lat, lon, height);
    }

    public async ValueTask DisposeAsync()
    {
        await JSRuntime.InvokeVoidAsync("cesiumHelpers.destroy");
    }
}
